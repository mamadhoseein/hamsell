# hamsell
ربات برای فروش اکانت وایرگاردو میکروتیک

# 🤖 Hamsell Panel (پنل Hamsell)

**ربات فروش اکانت مایکروتیک (MikroTik) با پنل وب پیشرفته**

**Hamsell** یک پروژه کامل پایتونی است که مدیریت و فروش اکانت‌های MikroTik را از طریق ربات تلگرام و یک پنل وب ادمین قدرتمند، ممکن می‌سازد.

## 🌟 ویژگی‌ها (امکانات اصلی)

* **پنل وب کامل:** داشبورد تحت وب برای مدیریت جامع ربات.
* **مدیریت سرویس:** راه‌اندازی، توقف و ری‌استارت سرویس‌های ربات و پنل از طریق داشبورد.
* **نصب آسان:** راه‌اندازی پروژه از طریق یک صفحه نصب تحت وب.
* **ساخت خودکار سرویس:** پنل وب فایل‌های سرویس `systemd` را برای اجرای دائمی ربات و پنل ایجاد می‌کند.
* **مشاهده لاگ:** نمایش زنده لاگ‌های ربات در پنل وب برای عیب‌یابی.
* **یکپارچگی با MikroTik:** اتصال مستقیم به `routeros_api` جهت مدیریت کاربران.
* **فناوری:** مبتنی بر **Pyrogram** (ربات تلگرام) و **Flask** (پنل وب).

***

## 📋 پیش‌نیازها

برای نصب، به موارد زیر نیاز دارید:

1.  **سرور لینوکس:** VPS با **Ubuntu 20.04/Debian 11** یا بالاتر و **Python 3.10+**.
2.  **دسترسی Root:** دسترسی `root` یا `sudo` برای نصب پکیج‌ها و سرویس‌ها.
3.  **اطلاعات تلگرام:** شامل `BOT_TOKEN`، `API_ID`/`API_HASH` (از my.telegram.org) و `MAIN_ADMIN_ID` (آیدی عددی ادمین).
4.  **اطلاعات MikroTik:** آی‌پی، نام کاربری و رمز عبور روتر.

***

## 🚀 راهنمای نصب قدم به قدم

این راهنما شما را از سرور خام تا راه‌اندازی کامل پروژه هدایت می‌کند.

### مرحله ۱: آماده‌سازی سرور

۱. به‌روزرسانی پکیج‌های سیستم:
```bash
sudo apt update && sudo apt upgrade -y
```
۲. نصب پکیج‌های مورد نیاز پایتون (pip و venv):
```bash
sudo apt install -y python3-pip python3-venv
```
## مرحله ۲: دریافت سورس و نصب پکیج‌ها
۱. سورس پروژه را کلون کرده و وارد پوشه شوید (فرض: مسیر /root/hamsell):
```bash
git clone https://github.com/mamadhoseein/hamsell.git /root/hamsell
cd /root/hamsell
```
۲. ساخت و فعال‌سازی محیط مجازی (myenv):
```bash
python3 -m venv myenv
source myenv/bin/activate
```
۳. نصب تمام پکیج‌های مورد نیاز از requirements.txt:
```bash
pip install --upgrade pip
pip install -r requirements.txt
```
##مرحله ۳: راه‌اندازی اولیه و تنظیمات وب
در این مرحله، پنل وب را فقط برای یک بار دستی اجرا می‌کنید تا تنظیمات را وارد کنید.

۱. (فقط برای بار اول) اجرای دستی پنل وب:
```bash
python3 web_dashboard.py
```
توجه: ترمینال شما در این حالت مشغول خواهد ماند.

۲. در مرورگر خود، آدرس http://[YOUR_SERVER_IP]:5000/install را باز کنید.

۳. با لاگین اولیه admin / admin وارد شوید.

۴. فرم نصب را با تمام اطلاعات تلگرام و MikroTik پر کنید و نام کاربری و رمز عبور جدید پنل وب را وارد نمایید.

۵. دکمه «نصب و راه‌اندازی نهایی» را بزنید.

اتفاقی که پس از نصب می‌افتد:
پنل وب تنظیمات شما را در فایل .env ذخیره می‌کند.

سرویس‌های config_bot.service و config_bot_web.service در /etc/systemd/system/ ایجاد می‌شوند.

سرویس‌ها با پایتون محیط مجازی (myenv) شروع به کار می‌کنند.

اجرای دستی پنل در ترمینال شما متوقف شده و به پس‌زمینه (سرویس systemd) منتقل می‌گردد.

## مرحله ۴: اتمام نهایی
۱. اجرای دستی اسکریپت را در ترمینال متوقف کنید (یا منتظر بمانید تا پس از ری‌استارت وب متوقف شود). ۲. محیط مجازی را غیرفعال کنید:
```bash
deactivate
```
نصب کامل شد! 🎉
## 🖥️ استفاده از پنل
از این پس، ربات و پنل وب شما به صورت خودکار در پس‌زمینه اجرا می‌شوند.

آدرس پنل: http://[YOUR_SERVER_IP]:5000 (به جای [YOUR_SERVER_IP] از آدرس IP واقعی سرور استفاده کنید).
لاگین: با استفاده از نام کاربری و رمز عبور جدید تنظیم‌شده در مرحله ۳ استفاده کنید.

مدیریت سرویس‌ها (از طریق SSH)
برای بررسی وضعیت سرویس‌ها:

وضعیت ربات:
```bash
systemctl status config_bot.service
```
وضعیت پنل وب:
```bash
systemctl status config_bot_web.service
```
لاگ‌های ربات (برای عیب‌یابی):
```bash
journalctl -u config_bot.service -f --no-pager
```

##🚀 نصب فوری
مراحل را باید به ترتیب برید.
## مرحله اول
دانلود کردن فایل نصبی!
```bash
wget https://github.com/mamadhoseein/hamsell/blob/main/hamsell
```
## مرحله دوم
دادن دسترسی به فایل 
```bash
chmod +x hamsell
```
## مرحله سوم
اجرا کردن فایل hamsell
```bash
hamsell
```
## 🤖 راهنمای گزینه‌های منو

* **1) Full Install (From Scratch)**
    * این گزینه پروژه را به صورت کامل از ابتدا نصب می‌کند.
    * نیازمندی‌های سیستمی (مانند `git` و `python3-venv`) را نصب می‌کند.
    * پروژه را از گیت‌هاب در مسیر `/opt/hamsell` کلون می‌کند.
    * نیازمندی‌های پایتون (مانند `flask` و `gunicorn`) را در یک محیط مجازی (venv) نصب می‌کند.
    * سرویس `systemd` را برای پنل وب (`config_bot_web.service`) ایجاد و اجرا می‌کند.

* **2) Install Dependencies (Fix missing modules)**
    * اگر با خطای "missing module" (نبود ماژول) مواجه شدید، از این گزینه استفاده کنید.
    * این دستور فقط نیازمندی‌های پایتون را در محیط مجازی (`venv`) نصب یا به‌روزرسانی می‌کند و سپس پنل وب را ریستارت می‌کند.

* **3) Update Project Code (Pull & Restart)**
    * برای به‌روزرسانی پروژه به آخرین نسخه موجود در گیت‌هاب.
    * ابتدا سرویس‌ها را متوقف می‌کند، سپس `git pull` می‌گیرد، نیازمندی‌ها را مجدد نصب می‌کند (برای ماژول‌های جدید) و در نهایت هر دو سرویس را ریستارت می‌کند.

* **4) Restart All Services**
    * هر دو سرویس (ربات تلگرام و پنل وب) را ریستارت (راه‌اندازی مجدد) می‌کند.

* **5) Check Service Status**
    * وضعیت فعلی (فعال، غیرفعال، یا دارای خطا) هر دو سرویس را نمایش می‌دهد.

* **6) Stop All Services**
    * هر دو سرویس (ربات تلگرام و پنل وب) را متوقف می‌کند.

* **7) Cleanup Project (Delete All)**
    * **(خطرناک!)** این گزینه پروژه را به طور کامل حذف می‌کند.
    * سرویس‌ها را متوقف کرده و فایل‌های `systemd` مربوطه را حذف می‌کند.
    * کل پوشه پروژه (`/opt/hamsell`) را به همراه محیط مجازی (`venv`) پاک می‌کند.

* **0) Exit**
    * از ابزار مدیریت خارج می‌شود.
